  <!DOCTYPE html>
  <html>
  <head>
    <title>Game of Life</title>
    <meta charset="UTF-8" http-equiv=”x-ua-compatible” content=”IE=edge” />
    <link rel="stylesheet" href="GameOfLifeCSS.css">
    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.24.0/babel.js"></script>

  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">

function Square(props){
  var color = "white"
  if(props.cells == 0){
        color = "black"
    }
    else if(props.cells == 1){
        color = "red"
    }

  var style = {
        height:20,
        width:20,
        border:"0.2px dotted gray",
        backgroundColor: color
    }

   return (
   <div style = {style}></div>
   )
}

function Row(props){
  var style = {
        display: "flex",
    }
  var square = []
  for(let i=0; i<50; i++){
    square.push(<Square key={i} row = {props.row} cells = {props.cells[i]} col = {i}/>)
  }

   return (
   <div style={style}>
       {square}
   </div>

   )
}

function Board(props){
  var rows = []
  for(let i=0; i<30; i++){
    rows.push(<Row key={i} cells = {props.cells[i]} row = {i} />)
  }

   return (
   <div>
       {rows}
   </div>

   )
}


class App extends React.Component{
  constructor(props){
    super(props)
    var cells = []
    for(let i = 0; i < 30; i++ ){
          cells.push(new Array(50).fill(0));
        }

    for(let i=0; i < 30; i++){
      for(let j=0; j < 50; j++){
      var x = Math.round(Math.random())
      cells[i][j] = x;
    }
    }
    //console.log("Start cells: " + cells);

    this.state = {cells: cells};
    this.nextGeneration = this.nextGeneration.bind(this);
 }

  nextGeneration(){
  console.log("**Inside next generation**");
    var cells = [], deadCells = [], aliveCells = []
        cells = this.state.cells.slice();
        //console.log("cells:" + cells);
        for(let i=0; i < 30; i++){
          for(let j=0; j < 50; j++){
             var population = 0;
             console.log("row:" + i + "  col:" + j + "  Value:" + cells[i][j])
              if (i > 0 && i < 29 && j > 0 && j < 49){
                  /*if (i ==28 && j == 48){
                     console.log("get population:");
                     console.log(cells[i-1][j-1] + cells[i-1][j] + cells[i-1][j+1] + cells[i][j-1] + cells[i][j+1] + cells[i+1][j-1] + cells[i+1][j] + cells[i+1][j+1]);
                     }
                  */
                 population = cells[i-1][j-1] + cells[i-1][j] + cells[i-1][j+1] + cells[i][j-1] + cells[i][j+1] + cells[i+1][j-1] + cells[i+1][j] + cells[i+1][j+1];
                 console.log("population:"+population);
              } else {
                  //console.log("population0:"+population);
                  if (i-1 >= 0 && j-1 >= 0) population += cells[i-1][j-1]
                  //console.log("population01:"+population);
                  if (i-1 >=0)  population +=cells[i-1][j]
                  //console.log("population02:"+population);
                  if (i-1 >= 0 && j+1 <= 49) population += cells[i-1][j+1]
                  //console.log("population03:"+population);
                  if (j-1 >= 0) population +=cells[i][j-1]
                  //console.log("population04:"+population);
                  if (j+1 <= 49) population +=cells[i][j+1]
                  //console.log("population05:"+population);
                  if (i+1 <= 29 && j-1 >= 0) population += cells[i+1][j-1]
                  //console.log("population06:"+population);
                  if (i+1 <= 29)  population +=cells[i+1][j]
                  //console.log("population07:"+population);
                  if (i+1 <= 29 && j+1 <= 49) population += cells[i+1][j+1]
                  console.log("population:"+population);
              }
             if (cells[i][j] == 1 && (population < 2 || population > 3)) {
                //live cell if under or over populated then dies
                //cells[i][j] = 0;
                deadCells.push([i,j]);
             } else if (cells[i][j] == 0 && population == 3) {
                //Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction
                //cells[i][j] = 1;
                aliveCells.push([i,j]);
             }

          } //inner for loop
        }
      if (deadCells.length > 0) {
        for(let i=0; i < deadCells.length; i++){
          cells[deadCells[i][0]][deadCells[i][1]] = 0;
        }
      }

      if (aliveCells.length > 0){
        for(let i=0; i < aliveCells.length; i++){
          cells[aliveCells[i][0]][aliveCells[i][1]] = 1;
        }
      }

     this.setState({cells: cells});
  } //nextGenration ends here

  start(){
    setInterval(this.nextGeneration.bind(this), 1000);
  }

  render(){
    return (
      <div>
      <div className="board">
        <Board cells = {this.state.cells}/>
      </div>
       <button onClick = { () => this.start()}>Start</button>
      </div>
    )
  }

}

  ReactDOM.render(
  <App />,
  document.getElementById('root')
  );

  </script>
  </body>
  </html>
